<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<title>Formulario Combustible Extraordinario</title>
	<meta charset="utf-8">
	<head th:replace="/layout/layoutHeadMetaData :: head"></head>
<body onload="cargar()">
	<header th:replace="/layout/layoutHead :: header"></header>
<section>
	 <div class="tab-content">
	      <div class="form-group last col-sm-12 formfondo" >
	                <div class="row">
	                    <div class="tab-content">
	                        <div class="col-sm-12">
	                            <div class="item-wrap">
	                                <div class="row">
	                                    <div class="col-md-12">		                                    	
	                                    
	                                        <form th:action="@{/formCombExt}" th:object="${combustible}" enctype="multipart/form-data" method="post" id="formulario"  name="visitas" data-toggle="validator" class="popup-form">
	                                            <div class="row">
	                                            	                                            
		                                                   
	                                                    <!--Presupuesto-->
	
	                                                    <div class="form-group col-sm-4">
															<div class="help-block with-errors"></div>
															<input th:field="*{presupuesto_ext}"  id="pres" placeholder="Presupuesto"  min="1" max="10000" class="form-control signos" type="number" required data-error="Presupuesto">
															<div class="input-group-icon"><i class="far fa-calendar-alt"></i></div>
														</div>
		                                                    
	                                                     <!--kilometraje_ord-->
	                                                    <div class="form-group col-sm-9">
	                                                            <div class="help-block with-errors"></div>
	                                                            <input th:field="*{kilometraje_ext}" th:value="*{kilometraje_ext}" id="Kilo" placeholder="Kilometraje Actual" class="form-control signos" type="text" disabled/>
	                                                            <div class="input-group-icon"><i class="fas fa-hashtag"></i></div>
	                                                    </div>
	 													<!--Fecha inicial-->
	                                                    <div class="form-group col-sm-9">
	                                                            <div class="help-block with-errors"></div>
	                                                            <input th:field="*{fecha_ini_ext}" id="Fini" step="1" min="2010-01-01" max="2050-12-31" placeholder="Fecha de inicio" class="form-control signos" type="date" required data-error="Ingrese la fecha Inicial"/>
	                                                            <div class="input-group-icon"><i class="fas fa-hashtag"></i></div>
	                                                    </div>
	                                                    
	                                                    <!--Fecha final-->
	                                                    <div class="form-group col-sm-9">
	                                                            <div class="help-block with-errors"></div>
	                                                            <input th:field="*{fecha_fin_ext}" id="Ffin" step="1" min="2010-01-01" max="2050-12-31" placeholder="Fecha de Fin" class="form-control signos" type="date" required data-error="Ingrese la fecha final"/>
	                                                            <div class="input-group-icon"><i class="fas fa-hashtag"></i></div>
	                                                    </div>
	                                                    
	                                                    <div class="form-group col-sm-12 enlineaform"></div>
	                                                     
	                                                     
	                                                    <h3 style="margin-left:1%;margin-top:.3%;margin-bottom: 3%;">Documento</h3>
	                                                     
	                                                     <!--Adjuntar documento -->
	                                                     
            										   <div class="form-group col-sm-12 enlineaform" th:if="${editar} == false">
															<p style="margin-bottom:2rem;">Foto del Odometro</p>
															<div class="col-sm-4"  id="Ndocumento">
																<div class="help-block with-errors"></div>
																<input id="doc" type="file" name="file" class="form-control" accept="image/png, image/jpg, image/jpeg" required data-error="Ingresa una imagen menor a 10 MB."/>																
															</div>
														</div>
														
													   <div class="form-group col-sm-12" th:if="${editar} == true">																														
															<div id="aBtnGroup" class="btn-group">
															    <button type="button" value="D" class="btn btn-default">Documento</button>
															    <button type="button" value="N" class="btn btn-default">Nuevo Documento</button>															    
															  </div>
															  
															<div class="col-sm-6" id="Ndocumento"  style="margin-top: 20px; display: none;">
																<div class="help-block with-errors"></div>
																<input id="doc2" type="file" name="file" class="form-control" accept="image/png, image/jpg, image/jpeg" data-error="Ingresa una imagen menor a 10 MB."/>
															</div>															
														
														
														<div id="Mdocumento" class=" col-sm-12">
															<div class="card-body d-flex justify-content-center enlinea" >
																	<embed th:src="@{'/upload/' + ${Odometro.odometro}}" type="application/pdf" class="col-sm-12" style="height:715px;"/>
															</div>
														</div>
														</div>			
	                                                    
	                                                    
	                                                    <input type="hidden" th:field="${Odometro.id_odo}"/>	                                                    
	                                                    <input type="hidden" th:field="*{id_asignacion}"/>
														<input type="hidden" th:field="*{asigCombustible}"/>
														<input type="hidden" th:field="${Odometro.odometro}"/>
														  
	                                                    <!--Boton Guardar-->
	                                                    <div class="form-group last col-sm-12">
	                                                            <button type="submit" id="guardar" class="btn btn-custom"><i class='fa fa-envelope'></i> Guardar</button>
	                                                    </div>
	                                                    <div class="clearfix"></div>
	                                            </div>
	                                        </form>
	                                    </div>
	                                </div>
	                            </div>
	                        </div>
	                    </div>
	                </div>
			</div>
			
		</div>
	</section>
	<script type="text/javascript">
		function cargar(){
			var d = new Date();
			var month = d.getMonth()+2;
			var day = d.getDate();	
			
			var output = d.getFullYear()+ '-' +
		    ((month<10 ? '0' : '') + month)+ '-' +
		    (day<10 ? '0' : '') + day ;
			
			$("#Ffin").val(output);
		}
		
		$('#aBtnGroup button').on('click', function() {
			var thisBtn = $(this);
			var btnText = thisBtn.text();
			var btnValue = thisBtn.val();
			thisBtn.addClass('active').siblings().removeClass('active');
		    if(btnValue == "D"){ 
		    	
		    	$("#Mdocumento").show();
		    	$("#Ndocumento").hide();
		    
		    };
		    if(btnValue == "N"){ 
		    	$("#Mdocumento").hide();
		    	$("#Ndocumento").show();
		    
		    };
		});
		
		$("#doc").change(function(){
			 
			var fileSize = this.files[0].size;

			if(fileSize > 3000000){
				swal("", "El archivo no debe superar los 3MB", "error");
				this.value = '';
				this.files[0].name = '';
			}else{
				 var fileName = this.files[0].name;
				// recuperamos la extensión del archivo
				var ext = fileName.split('.').pop();
				
				// Convertimos en minúscula porque 
				// la extensión del archivo puede estar en mayúscula
				ext = ext.toLowerCase();
		    
				// console.log(ext);
				switch (ext) {
					case 'jpg':break;
					case 'jpeg':break;
					case 'png':break;					
					default:
						swal("", "El archivo no tiene la extensión adecuada", "error");
						this.value = ''; // reset del valor
						this.files[0].name = '';
				}
				this.files[0].name = 'TC';
				console.log(this.files[0].name);
			}
	  	
	  });
		
		$("#doc2").change(function(){
			 
			var fileSize = this.files[0].size;

			if(fileSize > 3000000){
				swal("", "El archivo no debe superar los 3MB", "error");
				this.value = '';
				this.files[0].name = '';
			}else{
				 var fileName = this.files[0].name;
				// recuperamos la extensión del archivo
				var ext = fileName.split('.').pop();
				
				// Convertimos en minúscula porque 
				// la extensión del archivo puede estar en mayúscula
				ext = ext.toLowerCase();
		    
				// console.log(ext);
				switch (ext) {
					case 'jpg':break;
					case 'jpeg':break;
					case 'png':break;
					
					default:
						swal("", "El archivo no tiene la extensión adecuada", "error");
						this.value = ''; // reset del valor
						this.files[0].name = '';
				}
				this.files[0].name = 'TC';
				console.log(this.files[0].name);
			}
	  	
	  });
	</script>
	
	<script src="/assets/js/CambiosEstado.js"></script> 
	<!-- jQuery Library -->
	<script src="/assets/js/jquery-3.4.1.min.js"></script>
	<!-- Popper js -->
	<script src="/assets/js/popper.min.js"></script>
	<!-- Bootstrap Js -->
	<script src="/assets/js/bootstrap.min.js"></script>
	<!-- Form Validator -->
	<script src="/assets/js/validator.min.js"></script>
	<!-- Contact Form Js -->
	<script src="/assets/js/contact-form.js"></script>
	<!-- SweetAlert -->
	<script src="/assets/SweetAlert2/sweetalert2.min.js"></script>
	
	 
 
</body>
</html>
